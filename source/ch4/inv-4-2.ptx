<?xml version="1.0" encoding="UTF-8"?>
<section xml:id="investigation4-2">
  <title>Section 2: Comparing Two Population Means</title>
  
  <introduction>
    <p>In this section, we want to focus on quantitative data arising from two independent random samples. For example, in the first investigation you will compare the average travel distances of African and Asian elephants. For statistical inference, we need to explore how statistics like the difference in sample means behave under random sampling. We will first explore a hypothetical situation and then we then discuss a theoretical result justifying use of a <m>t</m>-distribution for the reference distribution in finding p-values and confidence intervals.</p>
  </introduction>
  
  <subsection xml:id="inv-4-2-elephants">
    <title>Investigation 4.2: The Elephants in the Room</title>
  
  <introduction>
    <sidebyside widths="60% 25%" valign="top">
      <p>Researchers Holdgate et al. (<url href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4944962/">2016</url>) studied walking behavior of elephants in North American zoos to see whether there is a difference in average distance traveled by African and Asian elephants in captivity. They put GPS loggers on 33 African elephants and 23 Asian elephants, and measured the distance (in kilometers) the elephants walked per day.</p>
      
      <image source="images/Inv4.2intro.png" width="100%">
        <description>Introduction image for Investigation 4.2</description>
      </image>
    </sidebyside>
  </introduction>
  
  <exercise xml:id="inv4-2-a" label="I4.2.1">
    <title>Identify Study Components</title>
    <statement>
      <p>Identify the observational units and variable of interest. Is the variable quantitative or categorical? Which graphs and numbers might you use to compare these two species?</p>
    </statement>
    <solution>
      <p>Observation units = 56 elephants, Variable = How many km did the elephant walk per day? This is a quantitative variable. We could look at dotplots, boxplots, histograms, means/SDs, five number summaries in order to compare the walking distances.</p>
    </solution>
    <response/>
  </exercise>
  
  <p>Open the <url href="https://www.rossmanchance.com/iscam3/data/elephants.txt">elephants.txt</url> data file. First, look at the data by creating a graph of distances separated by species. When using graphs to compare groups it is especially important that comparative graphs be drawn on the same scale. <alert>Note:</alert> These data are stacked as each column is a different variable (species and distance).</p>
    
  <exercise xml:id="inv4-2-b" label="I4.2.2">
    <title>Create Comparative Graphs - Applet</title>
    <statement>
      <p>Use the <url href="https://www.rossmanchance.com/applets/2021/descstats/Dotplot.htm">Descriptive Statistics applet</url> to create comparative graphs:</p>
      <ul>
        <li><p>Copy the data to the clipboard. In the applet, check the Stacked box. Press Clear and paste the data into the Sample data window and press Use Data. (Or type elephants.txt in the empty Paste data window.)</p></li>
        <li><p>Use the Separate by pull-down menu to select the Species categorical variable</p></li>
        <li><p>You have radio button options for Histograms and Boxplots.</p></li>
      </ul>
    </statement>
    <response/>
  </exercise>
  
  <exercise xml:id="inv4-2-b2" label="I4.2.2b">
    <title>Create Comparative Graphs - R</title>
    <statement>
      <p>Use R to create comparative graphs:</p>
      <sage language="r">
        <input>
# Load ISCAM functions from GitHub
source("https://raw.githubusercontent.com/iambethchance/iscam-runestone/master/ISCAM-functions.R")

# Load elephant data from GitHub
elephants = read.table("https://raw.githubusercontent.com/iambethchance/iscam-runestone/master/data/elephants.txt", header=TRUE)

# Create dotplot
iscamdotplot(elephants$Distance, elephants$Species, xlab="Distance (km)")

# Boxplot
boxplot(Distance ~ Species, data=elephants, horizontal=TRUE, 
        xlab="Distance (km)", ylab="Species")
        </input>
      </sage>
    </statement>
  </exercise>
  
  <exercise xml:id="inv4-2-b3" label="I4.2.2c">
    <title>Create Comparative Graphs - JMP</title>
    <statement>
      <p>Use JMP to create comparative graphs:</p>
      <ul>
        <li><p>Choose Analyze > Distribution and specify both the quantitative variable (Y, Columns) and the categorical variable (By).</p></li>
        <li><p>Press OK.</p></li>
        <li><p>Use the Distributions hot spot to select Stack</p></li>
        <li><p>OR use Graph > Graph Builder. Drag Distance to the X axis and Species to the Y axis. Use the icons across the top to change to boxplots and histograms.</p></li>
      </ul>
      <p><alert>Note:</alert> When comparing groups, some boxplot displays vary the other dimension of the box size by relative sample size.</p>
    </statement>
  </exercise>
    
    <exercise xml:id="inv4-2-c" label="I4.2.7">
      <title>Identify Outliers</title>
      <statement>
        <p>According to the boxplots, were there any <q>outlier</q> elephants? Explain how you know.</p>
      </statement>
      <hint>
        <p>Outliers are typically shown as individual points beyond the whiskers of the boxplot.</p>
      </hint>
      <response/>
      <solution>
        <p>Yes, there appear to be outliers in both groups. The boxplot will show these as individual points beyond the whiskers, indicating elephants that walked unusually long or short distances compared to others in their group.</p>
      </solution>
    </exercise>
    
    <exercise xml:id="inv4-2-d" label="I4.2.8">
      <title>Limitation of Boxplots</title>
      <statement>
        <p>What is a limitation to using only boxplots to compare these two distributions?</p>
      </statement>
      <hint>
        <p>Think about what information boxplots show versus what they hide about the distribution.</p>
      </hint>
      <response/>
      <solution>
        <p>Boxplots only show summary statistics (median, quartiles, range) and outliers. They don't show the actual shape of the distribution, the number of observations at different values, or whether there are multiple modes. Dotplots or histograms provide more detailed information about the distribution's shape.</p>
      </solution>
    </exercise>
    
    <exercise xml:id="inv4-2-e" label="I4.2.9">
      <title>Compare Distributions</title>
      <statement>
        <p>Explore the differences in the walking distances between the African and Asian elephants. Which species tended to walk more? Which species showed greater variability? Which distribution is more symmetric?</p>
      </statement>
      <hint>
        <p>Look at the centers, spreads, and shapes of the two distributions.</p>
      </hint>
      <response/>
      <solution>
        <p>African elephants tended to walk more on average (higher center). Asian elephants showed greater variability (wider spread). The Asian elephant distribution appears more symmetric, while the African elephant distribution may be slightly skewed.</p>
      </solution>
    </exercise>
    
    <p>And we can calculate separate summary statistics for the two species:</p>
    
  <exercise xml:id="inv4-2-d1" label="I4.2.3">
    <title>Calculate Numerical Summaries - Applet</title>
    <statement>
      <p>Use the <url href="https://www.rossmanchance.com/applets/2021/descstats/Dotplot.htm">Descriptive Statistics applet</url> to calculate numerical summaries:</p>
      <ul>
        <li><p>Check the Mean: Actual and Std dev: Actual boxes (at least)</p></li>
      </ul>
    </statement>
  </exercise>
  
  <exercise xml:id="inv4-2-d2" label="I4.2.3b">
    <title>Calculate Numerical Summaries - R</title>
    <statement>
      <p>Use R to calculate numerical summaries:</p>
      <sage language="r">
        <input>
# Load ISCAM functions from GitHub
source("https://raw.githubusercontent.com/iambethchance/iscam-runestone/master/ISCAM-functions.R")

# Load elephant data from GitHub
elephants = read.table("https://raw.githubusercontent.com/iambethchance/iscam-runestone/master/data/elephants.txt", header=TRUE)

# Summary statistics by species
# For African elephants
african = subset(elephants, Species == "African")
cat("African Elephants:\n")
cat("n =", length(african$Distance), "\n")
cat("Mean =", mean(african$Distance), "\n")
cat("SD =", sd(african$Distance), "\n\n")

# For Asian elephants
asian = subset(elephants, Species == "Asian")
cat("Asian Elephants:\n")
cat("n =", length(asian$Distance), "\n")
cat("Mean =", mean(asian$Distance), "\n")
cat("SD =", sd(asian$Distance), "\n")
        </input>
      </sage>
    </statement>
  </exercise>
  
  <exercise xml:id="inv4-2-d3" label="I4.2.3c">
    <title>Calculate Numerical Summaries - JMP</title>
    <statement>
      <p>Use JMP to calculate numerical summaries:</p>
      <ul>
        <li><p>Choose Analyze > Distribution and specify both the quantitative variable (Y, Columns) and the categorical variable (By).</p></li>
        <li><p>Press OK.</p></li>
        <li><p>Use the Distributions hot spot to select Stack.</p></li>
      </ul>
    </statement>
  </exercise>
    
    <exercise xml:id="inv4-2-f" label="I4.2.10">
      <title>Record Summary Statistics</title>
      <statement>
        <p>Determine the sample sizes, sample means, and the sample standard deviations for each group and record these below, using appropriate symbols.</p>
        <table>
          <title>Summary Statistics for Elephant Walking Distances</title>
          <tabular halign="center" top="minor" bottom="minor" left="minor" right="minor">
            <row header="yes">
              <cell></cell>
              <cell>n</cell>
              <cell>Mean</cell>
              <cell>SD</cell>
            </row>
            <row>
              <cell>African</cell>
              <cell><var width="5"/></cell>
              <cell><var width="8"/></cell>
              <cell><var width="8"/></cell>
            </row>
            <row>
              <cell>Asian</cell>
              <cell><var width="5"/></cell>
              <cell><var width="8"/></cell>
              <cell><var width="8"/></cell>
            </row>
          </tabular>
        </table>
      </statement>
      <response/>
    </exercise>
    
    <exercise xml:id="inv4-2-g" label="I4.2.11">
      <title>Predict Statistical Significance</title>
      <statement>
        <p>Do you think the difference in sample means is going to be statistically significant? What does statistical significance mean in this context? (What null and alternative hypotheses can we test?)</p>
      </statement>
      <response/>
    </exercise>
    
    <p>Before we can address statistical significance, we need more information as to how much we expect a difference in sample means to vary from sample to sample (e.g., what if we had lots of different zoos, each with random samples of each type of elephant). We will take a detour to explore this in a case where we have the populations to begin with to see some rather familiar results.</p>
    
    <exercise xml:id="inv4-2-h" label="I4.2.12">
      <title>Outline Simulation Steps</title>
      <statement>
        <p>Outline the simulation steps we need to use.</p>
      </statement>
      <response/>
    </exercise>
    
    <subsection xml:id="prob-detour-two-means">
      <title>Probability Detour: Sampling Distribution of Difference in Two Means</title>
      
      <p>To understand how differences in sample means behave, let's explore a hypothetical scenario where we know the population distributions. We'll use NBA player salary data to investigate.</p>
      
      <exercise xml:id="prob-detour-2means-a" label="PD4.2.1">
        <title>Salary Distribution Shape</title>
        <statement>
          <p>Why might salaries be skewed to the right?</p>
        </statement>
        <response/>
      </exercise>
      
      <exercise xml:id="prob-detour-2means-b" label="PD4.2.2">
        <title>Mean vs Median</title>
        <statement>
          <p>With a skewed right distribution, would you expect the mean to be larger or smaller than the median?</p>
        </statement>
        <response/>
      </exercise>
      
      <exercise xml:id="prob-detour-2means-c" label="PD4.2.3">
        <title>Population Parameters</title>
        <statement>
          <p>Open the <url href="https://raw.githubusercontent.com/iambethchance/iscam-runestone/master/data/NBASalaries2025.txt">NBASalaries2025.txt</url> data file (see also <url href="http://www.espn.com/nba/salaries">ESPN NBA salaries</url>). Record the sample sizes, means, and standard deviations for the Western and Eastern conferences.</p>
        </statement>
        <response/>
      </exercise>
      
      <exercise xml:id="prob-detour-2means-d" label="PD4.2.4">
        <title>Sample Statistics</title>
        <statement>
          <p>Take a random sample of size 20 from each conference. Record the sample means and standard deviations. How do they compare to the population values?</p>
        </statement>
        <response/>
      </exercise>
      
      <exercise xml:id="prob-detour-2means-e" label="PD4.2.5">
        <title>Generate Sampling Distribution</title>
        <statement>
          <p>Repeat this process many times (at least 1000) to generate a sampling distribution of the difference in sample means (East - West).</p>
        </statement>
        <response/>
      </exercise>
      
      <exercise xml:id="prob-detour-2means-f" label="PD4.2.6">
        <title>Shape of Distribution</title>
        <statement>
          <p>Describe the shape of the sampling distribution of the difference in sample means. How does it compare to the shape of the salary distributions themselves?</p>
        </statement>
        <response/>
      </exercise>
      
      <exercise xml:id="prob-detour-2means-g" label="PD4.2.7">
        <title>Center of Distribution</title>
        <statement>
          <p>What is the center of the sampling distribution? What does this represent?</p>
        </statement>
        <response/>
      </exercise>
      
      <exercise xml:id="prob-detour-2means-h" label="PD4.2.8">
        <title>Variability</title>
        <statement>
          <p>How does the variability in the sampling distribution of differences in means compare to the variability in individual salaries?</p>
        </statement>
        <response/>
      </exercise>
      
      <exercise xml:id="prob-detour-2means-i" label="PD4.2.9">
        <title>Predicted Standard Error</title>
        <statement>
          <p>From each conference we can predict the standard error to be <m>\sigma/\sqrt{n}</m>. Calculate this for each conference and compare to the standard deviation of the difference in sample means.</p>
        </statement>
        <response/>
      </exercise>
      
      <exercise xml:id="prob-detour-2means-j" label="PD4.2.10">
        <title>Summary of Results</title>
        <statement>
          <p>Summarize your findings about the distribution of the difference in sample means (shape, center, spread).</p>
        </statement>
        <response/>
      </exercise>
      
      <exercise xml:id="prob-detour-2means-k" label="PD4.2.11">
        <title>Why Not Perfect Normal?</title>
        <statement>
          <p>Why might the distribution not follow the theoretical predictions exactly?</p>
        </statement>
        <hint>
          <p>Consider the nature of the population distributions and sampling.</p>
        </hint>
        <response/>
      </exercise>
      
      <exercise xml:id="prob-detour-2means-l" label="PD4.2.12">
        <title>Using Sample Standard Deviations</title>
        <statement>
          <p>In practice, we don't know the population standard deviations. We estimate the standard error using: <m>\sqrt{s_1^2/n_1 + s_2^2/n_2}</m>. Calculate this predicted standard deviation and compare to your simulation results.</p>
        </statement>
        <response/>
      </exercise>
      
      <exercise xml:id="prob-detour-2means-m" label="PD4.2.13">
        <title>Standardized Statistics</title>
        <statement>
          <p>Create a new distribution by standardizing each difference: <m>t = \frac{(\bar{x}_1 - \bar{x}_2) - (\mu_1 - \mu_2)}{\sqrt{s_1^2/n_1 + s_2^2/n_2}}</m>. Describe the shape of this distribution. Does it appear to follow a <m>t</m>-distribution?</p>
        </statement>
        <response/>
      </exercise>
    </subsection>
    
    <subsection xml:id="elephants-continued">
      <title>Back to the Elephants</title>
      
      <exercise xml:id="inv4-2-i" label="I4.2.13">
        <title>Technical Conditions</title>
        <statement>
          <p>Are the technical conditions met for the t-procedures to be valid for these data?</p>
        </statement>
        <response/>
      </exercise>
      
      <exercise xml:id="inv4-2-j" label="I4.2.14">
        <title>Hypothesis Test</title>
        <statement>
          <p>Use technology to decide whether there is a statistically significant difference between the average walking distance of the African and Asian elephant populations. State the hypotheses, define any symbols you use, report the test-statistic and p-value. Include one-sentence interpretations of both the standardized statistic and the p-value in context. What conclusion do you draw?</p>
        </statement>
        <response/>
      </exercise>
      
      <exercise xml:id="inv4-2-j1" label="I4.2.14a">
        <title>Two-Sample <m>t</m>-Test - Applet</title>
        <statement>
          <p>Use the Theory-Based Inference applet to conduct a two-sample <m>t</m>-test:</p>
          
          <image source="images/Inv4.2TBIA.png" width="80%">
            <description>Theory-Based Inference applet for unpooled two-sample t-test with summary data</description>
          </image>
          
          <ul>
            <li><p>Select Two Means from the pull-down menu</p></li>
            <li><p>Choose Unpooled</p></li>
            <li><p>Enter the sample sizes, means, and standard deviations for each group</p></li>
            <li><p>Choose the alternative hypothesis (typically not equal for two-sided)</p></li>
            <li><p>Press Calculate to get the test statistic, degrees of freedom, and p-value</p></li>
          </ul>
        </statement>
      </exercise>
      
      <exercise xml:id="inv4-2-j2" label="I4.2.14b">
        <title>Two-Sample <m>t</m>-Test - R</title>
        <statement>
          <p>Use R to conduct a two-sample <m>t</m>-test:</p>
          <sage language="r">
            <input>
# Load elephant data
elephants = read.table("https://raw.githubusercontent.com/iambethchance/iscam-runestone/master/data/elephants.txt", header=TRUE)

# Two-sample t-test (unpooled - Welch's t-test)
t.test(Distance ~ Species, data=elephants, var.equal=FALSE)

# Note: var.equal=FALSE uses the unpooled (Welch) version
# This is the default and recommended when variances may differ
            </input>
          </sage>
        </statement>
      </exercise>
      
      <exercise xml:id="inv4-2-j3" label="I4.2.14c">
        <title>Two-Sample <m>t</m>-Test - JMP</title>
        <statement>
          <p>Use JMP to conduct a two-sample <m>t</m>-test:</p>
          
          <image source="images/Inv4.2JMP3.png" width="80%">
            <description>JMP output for unpooled two-sample t-test</description>
          </image>
          
          <ul>
            <li><p>Choose Analyze > Fit Y by X</p></li>
            <li><p>Put the quantitative variable in Y, Response and the categorical variable in X, Factor</p></li>
            <li><p>Press OK</p></li>
            <li><p>Click on the red triangle next to Oneway Analysis and select t Test</p></li>
            <li><p>JMP provides both pooled and unpooled (Welch) results</p></li>
          </ul>
        </statement>
      </exercise>
      
      <exercise xml:id="inv4-2-j4" label="I4.2.14d">
        <title>Two-Sample <m>t</m>-Test with Raw Data - Applet</title>
        <statement>
          <p>Use the Theory-Based Inference applet with raw data:</p>
          
          <image source="images/Inv4.2TBIA2.png" width="80%">
            <description>Theory-Based Inference applet for unpooled two-sample t-test with raw data</description>
          </image>
          
          <ul>
            <li><p>Select Two Means from the pull-down menu</p></li>
            <li><p>Check the Stacked box if your data are in stacked format</p></li>
            <li><p>Enter elephants.txt in the data window or paste the data</p></li>
            <li><p>Press Use Data</p></li>
            <li><p>Select the response variable and grouping variable</p></li>
            <li><p>Choose Unpooled</p></li>
            <li><p>Press Calculate</p></li>
          </ul>
        </statement>
      </exercise>
      
      <p>The applet uses the <url href="https://en.wikipedia.org/wiki/Welch%E2%80%93Satterthwaite_equation">Welch-Satterthwaite approximation</url> to calculate the degrees of freedom when the population variances are not assumed equal.</p>
      
      <sidebyside widths="60% 35%" valign="top">
        <p>In this case, we could use 19 as the approximate degrees of freedom. Notice that this sample size is large enough that the <m>t</m>-distribution looks a lot like the normal distribution as well, which should agree with your observation in (m). But we will continue to use the <m>t</m>-distribution rather than the normal distribution to still account for additional variation from our estimates of the population standard deviations.</p>
        
        <image source="images/Inv4.2tnorm.png" width="100%">
          <description>Comparison of <m>t</m>-distribution with 19 df and normal distribution</description>
        </image>
      </sidebyside>
      
      <exercise xml:id="inv4-2-k" label="I4.2.19">
        <title>Confidence Interval</title>
        <statement>
          <p>Also approximate a 95% confidence interval and interpret this interval in context. [Hint: When interpreting a confidence interval for the difference, you should always clarify the direction of subtraction and which population parameter is larger.]</p>
        </statement>
        <response/>
      </exercise>
      
      <assemblage xml:id="study-conclusions-4-2">
        <title>Study Conclusions</title>
        
        <p>In this study, the mean distance walked is similar for these two species (5.40 vs. 5.30 km) and the sample sizes are not super large (33 and 23), with a fair bit of variation in walking distances within each species (<m>s_{\text{African}} = 1.47</m> vs <m>s_{\text{Asian}} = 3.41</m> km). For these reasons, we do not expect a small p-value. The distributions are fairly symmetric so the unpooled t-test should be valid (the standard deviations are not very similar, so we would not feel comfortable assuming equal population variances). The unpooled t-test statistic of 0.131 is small, yielding a two-sided p-value of 0.897. We fail to reject the null hypothesis that the population mean walking distances are the same. These data do not provide convincing evidence of a difference in walking distances, on average, between Asian and African elephants in American zoos. A 95% confidence interval tells us that its plausible that, in these two populations, African elephants average up to 1.45 km less to 1.65 km more than Asian elephants. It might be interesting to further explore the larger variation in walking distances among the Asian elephants. We should also be aware that we have sampled a large fraction of the populations and should consider some "finite population corrections" which would only further increase the standard deviation.</p>
      </assemblage>
      
      <p>Keep in mind that the t-tests only tells us about whether the centers of the distributions are significantly different. They don't help us analysis other potentially interesting differences in the two distributions.</p>
      
      <p>For more information on the <url href="https://en.wikipedia.org/wiki/Pooled_variance#Pooled_standard_deviation">pooled t-test</url>, which assumes equal population variances, see the linked resource. In practice, the unpooled (Welch) t-test is generally preferred as it is more robust to violations of the equal variance assumption.</p>
    </subsection>
    
    <subsection xml:id="practice-problems-4-2">
      <title>Practice Problems</title>
      
      <exercise xml:id="practice-4-2-a" label="PP4.2A">
        <title>Bootstrap Sampling</title>
        <statement>
          <p>Open the Sampling from Two Sample Bootstrapping applet.</p>
          <ul>
            <li><p>Enter <url href="https://raw.githubusercontent.com/iambethchance/iscam-runestone/master/data/elephants.txt">elephants.txt</url> in the data window and press Use Data (twice).</p></li>
            <li><p>Check Show Sampling Options</p></li>
            <li><p>Press Bootstrap Samples</p></li>
            <li><p>Look at the Plot display.</p></li>
          </ul>
          
          <p>(a) Include a screen capture of your bootstrap sample and verify you have selected 23 Asian elephants and 33 African elephants.</p>
          
          <p>(b) Identify any elephants that were selected more than once, and explain how you can tell, AND how you can tell that the two groups were not pooled together before sampling.</p>
          
          <p>(c) Now check the Pooled box and press Bootstrap Samples. Include a screen capture of your bootstrap sample.</p>
          
          <p>(d) Identify any elephants that were selected more than once, and explain how you can tell, AND how you can tell that the two groups were pooled together before sampling. (Feel free to generate a different sample if another one would make your point better.)</p>
          
          <p>(e) Which simulation should we use for a test of significance, and which for a confidence interval? Briefly explain why.</p>
        </statement>
        <response/>
      </exercise>
      
      <exercise xml:id="practice-4-2-b" label="PP4.2B">
        <title>Bootstrap for Medians</title>
        <statement>
          <p>(a) Use the Two sample bootstrapping applet (see also Exploration 2.9) to simulate a null distribution for the difference in medians. Do you think a t-approximation would be valid for this statistic? Why or why not.</p>
          
          <p>(b) Approximate a p-value. Is your conclusion similar as in the analysis with means?</p>
          
          <p>(c) Has your analysis proven that there is no difference in the median walking distances between these two species? Explain.</p>
        </statement>
        <response/>
      </exercise>
      
      <exercise xml:id="practice-4-2-c" label="PP4.2C">
        <title>Alternative Scenario</title>
        <statement>
          <p>Suppose our data had been:</p>
          
          <image source="images/PP4.2C.png" width="80%">
            <description>Alternative elephant data scenario for Practice Problem 4.2C</description>
          </image>
          
          <p>(a) Conjecture how this will impact the p-value and confidence interval. Explain your reasoning.</p>
          
          <p>(b) Use technology to check your conjecture. Were you correct?</p>
          
          <p>(c) Do you consider the t-procedures more valid here than for the actual study? Explain.</p>
        </statement>
        <response/>
      </exercise>
    </subsection>
  </subsection>
    
  </section>