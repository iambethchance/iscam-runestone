<?xml version="1.0" encoding="UTF-8"?>
<section xml:id="inv-4-7-cloud-seeding">
  <title>Investigation 4.7: Cloud Seeding</title>
  
  <introduction>
    <sidebyside widths="70% 25%" margins="0% 5%">
      <stack>
        <p>The 2024 movie <em>Twisters</em> mentions how injecting silver iodide into clouds can convert atmospheric moisture into rain. Scientists have long considered this for increasing rainfall in drought regions. In one study, researchers in southern Florida explored whether injecting silver iodide into cumulus clouds would lead to increased rainfall. On each of 52 days that were judged to be suitable for cloud seeding, a target cloud was identified and a plane flew through the target cloud in order to seed it. Randomization was used to determine whether or not to load a seeding mechanism and seed the target cloud with silver iodide on that day. </p>
      </stack>
      <image source="images/Inv4.7intro.jpg">
        <description>Cloud seeding aircraft</description>
      </image>
    </sidebyside>
<p>Radar was used to measure the volume of rainfall from the selected cloud during the next 24 hours. The results below and in <url href="https://raw.githubusercontent.com/iambethchance/iscam-runestone/master/data/CloudSeeding.txt">CloudSeeding.txt</url> (from <url href="https://www.jstor.org/stable/1268346">Simpson, Olsen, and Eden, 1975</url>) measure rainfall in volume units of acre-feet, <q>height</q> of rain across one acre.</p>    
    <p><alert>Unseeded:</alert></p>
    <p>1.0, 4.9, 4.9, 11.5, 17.3, 21.7, 24.4, 26.1, 26.3, 28.6, 29.0, 36.6, 41.1, 47.3, 68.5, 81.2, 87.0, 95.0, 147.8, 163.0, 244.3, 321.2, 345.5, 372.4, 830.1, 1202.6</p>
    
    <p><alert>Seeded:</alert></p>
    <p>4.1, 7.7, 17.5, 31.4, 32.7, 40.6, 92.4, 115.3, 118.3, 119.0, 129.6, 198.6, 200.7, 242.5, 255.0, 274.7, 274.7, 302.8, 334.1, 430.0, 489.1, 703.4, 978.0, 1656.0, 1697.8, 2745.6</p>
  </introduction>
  
  <p><alert>Study Design</alert></p>
  
  <exercise xml:id="inv4-7-a" label="I4.7.1">
    <title>Identify Variables</title>
    <statement>
      <p>Identify the observational/experimental units, explanatory variable, and response variable.</p>
      <p>Observational/experimental units: <var width="50"/></p>
      <p>Explanatory: <var width="50"/></p>
      <p>Response: <var width="50"/></p>
    </statement>
    <solution>
      <p>Observational/experimental units: The 52 clouds (or days)</p>
      <p>Explanatory: Was the cloud seeded? (binary categorical)</p>
      <p>Response: How many acre-feet of rain was measured from the cloud? (quantitative)</p>
    </solution>
    <response/>
  </exercise>
  
  <exercise xml:id="inv4-7-b" label="I4.7.2">
    <title>Experiment or Observational Study</title>
    <statement>
      <p>Is this an experiment or an observational study?</p>
    </statement>
    <choices randomize="no">
      <choice correct="yes">
        <statement><p>Experiment</p></statement>
      </choice>
      <choice>
        <statement><p>Observational study</p></statement>
      </choice>
    </choices>
    <response/>
    <statement>
      <p>Explain: <var width="60"/></p>
    </statement>
    <solution>
      <p>Experiment because the researchers decided which clouds were seeded. This was done with random assignment and presumably the pilots were blind to whether or not they were seeding a cloud and the person evaluating the rainfall was blind to whether or not that cloud had been seeded.</p>
    </solution>
  </exercise>
  
  <p><alert>Descriptive Statistics</alert></p>
  
  <p>Below are graphical displays and summary statistics for these two distributions:</p>
  
  <image source="images/Inv4.7fig1.png" width="80%">
    <description>Histogram and boxplot of rainfall by treatment</description>
  </image>
  
  <image source="images/Inv4.7fig2.png" width="80%">
    <description>Dotplot of rainfall by treatment</description>
  </image>
  
  <tabular halign="center" top="medium" bottom="medium" left="medium" right="medium">
    <row header="yes" bottom="medium">
      <cell right="medium">treatment</cell>
      <cell right="medium"><m>n</m></cell>
      <cell right="medium">Mean</cell>
      <cell right="medium">SE Mean</cell>
      <cell right="medium">StDev</cell>
      <cell right="medium">Minimum</cell>
      <cell right="medium">Q1</cell>
      <cell right="medium">Median</cell>
      <cell right="medium">Q3</cell>
      <cell right="medium">Maximum</cell>
      <cell>Skewness</cell>
    </row>
    <row bottom="medium">
      <cell halign="left" right="medium">seeded</cell>
      <cell right="medium">26</cell>
      <cell right="medium">442</cell>
      <cell right="medium">128</cell>
      <cell right="medium">651</cell>
      <cell right="medium">4</cell>
      <cell right="medium">79</cell>
      <cell right="medium">222</cell>
      <cell right="medium">445</cell>
      <cell right="medium">2746</cell>
      <cell>2.44</cell>
    </row>
    <row>
      <cell halign="left" right="medium">unseeded</cell>
      <cell right="medium">26</cell>
      <cell right="medium">164.6</cell>
      <cell right="medium">54.6</cell>
      <cell right="medium">278.4</cell>
      <cell right="medium">1.0</cell>
      <cell right="medium">23.7</cell>
      <cell right="medium">44.2</cell>
      <cell right="medium">183.3</cell>
      <cell right="medium">1202.6</cell>
      <cell>2.79</cell>
    </row>
  </tabular>
  
  <exercise xml:id="inv4-7-c" label="I4.7.3">
    <title>Preliminary Evidence</title>
    <statement>
      <p>Based on the graphs and summary statistics, is there preliminary evidence that cloud seeding is effective? (Include a calculation of the difference in the group means and in the group medians.)</p>
    </statement>
    <solution>
      <p>There does appear to be a tendency for the seeded clouds to have more rainfall than the unseeded clouds. The dotplot is shifted slightly to the right of the dotplot for the unseeded clouds and all five numbers in the five number summary are larger for the seeded clouds.</p>

      <p>Difference in means: <m>442 - 164.6 = 277.4</m> acre-feet</p>
      <p>Difference in medians: <m>222 - 44.2 = 177.8</m> acre-feet</p>
    </solution>
    <response/>
  </exercise>
  
  <exercise xml:id="inv4-7-d" label="I4.7.4">
    <title>Validity of Two-Sample <em>t</em>-Test</title>
    <statement>
      <p>Would it be reasonable to apply a two-sample <em>t</em>-test to assess the statistical significance of the difference in the sample means? Explain.</p>
    </statement>
    <solution>
      <p>Both distributions are strongly skewed to the right (skewness values 2.44 and 2.79) and the sample sizes are not huge, so we might be hesitant to apply the two-sample <em>t</em>-test to these data.</p>
    </solution>
    <response/>
  </exercise>

  <aside>
    <title>Applet</title>
    <p><url href="https://www.rossmanchance.com/applets/2021/tbia/TBIA.html?hideExtras=1">Theory-Based Inference</url> applet</p>
  </aside>

  <exercise xml:id="inv4-7-e" label="I4.7.5">
    <title>Conduct Two-Sample <em>t</em>-Test</title>
    <statement>
      <p>Regardless of your answer to <xref ref="inv4-7-d" text="custom">checkpoint 16.4.4</xref>, carry out a two-sample <em>t</em>-test and a confidence interval to determine the strength of evidence of higher average rainfall with the seeded clouds.</p>
    </statement>
    <solution>
      <p>Using technology, the two-sample <em>t</em>-test gives a two-sided p-value = 0.054. We have moderate evidence of a difference in the mean rainfall for these two treatments. The one-sided p-value can be found by taking <m>0.054/2 = 0.027</m> because the observed difference is in the conjectured direction. We have strong evidence that, on average, seeded clouds have more rainfall than unseeded clouds.</p>
      <image source="images/Inv4.7solseR.png" width="70%">
      <em>R output:</em>
        <description>Two-sample t-test output for original rainfall data (R)</description>
      </image>
      <em>JMP output:</em>
      <image source="images/Inv4.7solseJMP.png" width="70%">
        <description>Two-sample t-test output for original rainfall data (JMP)</description>
      </image>
    </solution>
    <response/>
  </exercise>
  
  
  <exercise xml:id="inv4-7-f" label="I4.7.6">
    <title>Alternative Approaches</title>
    <statement>
      <p>But if we don't totally trust these results, what other approaches have you learned that could be applied here instead of a two-sample <em>t</em>-test to assess the statistical significance of the difference in group means? (See <xref ref="inv-2-8">Investigation 2.8</xref> for a similar situation.)</p>
    </statement>
    <solution>
      <p>Simulation - we can use the random assignment applet to approximate the p-value. We could also consider analyzing the difference in medians instead of means, or transform the data (e.g., log transformation) to make the distributions more symmetric.</p>
    </solution>
    <response/>
  </exercise>
  
  <p><alert>Choice of Statistic</alert></p>
  
  <p>One approach to compensate for the skewness and outliers in these rainfall distributions is to analyze the difference in medians instead of the difference in means. Fortunately, an advantage of the randomization test is that it applies just as well, and just as easily, to comparing medians.</p>
  
  <exercise xml:id="inv4-7-g" label="I4.7.7">
    <title>Randomization Test for Medians</title>
    <statement>
      <p>Modify the previous code from the Technology Detour in <xref ref="inv-4-4-sleep">Investigation 4.4</xref> (remember to load/attach the CloudSeeding.txt data, to match the sample sizes in the actual study, and to consider the difference in medians as the statistic), or use the <url href="https://www.rossmanchance.com/applets/2021/anovashuffle/AnovaShuffle.htm?hideExtras=2">Comparing Groups (Quantitative) applet</url>, to calculate an empirical p-value for the difference in medians for this study. Report the p-value and your conclusion about the effect of cloud seeding on median rainfall amounts.</p>
    </statement>
    <hint>
      <p>What is the observed difference?</p>
    </hint>
    <response/>
    <solution>
      <p>The observed difference in medians is <m>-177.4</m> (unseeded minus seeded, or <m>177.4</m> for seeded minus unseeded). Using simulation (e.g., Comparing Groups Quantitative applet), the p-value is approximately 0.009. This provides strong evidence that cloud seeding increases the median rainfall amount.</p>
      <image source="images/Inv4.7solsg.jpg" width="70%">
        <description>Randomization distribution for difference in medians</description>
      </image>
    </solution>
  </exercise>
  
  <exercise xml:id="inv4-7-h" label="I4.7.8">
    <title>Normal Model for Median Differences</title>
    <statement>
      <p>Would it be reasonable to model the randomization distribution for the difference in medians with a normal or <em>t</em>-distribution? Explain. What about creating a confidence interval using statistic ± 2SD? What would this interval tell you?</p>
    </statement>
    <solution>
      <p>The distribution looks a little strange, not nearly as nicely bell-shaped and symmetric (and filled in) as the distribution of the differences in sample means. It would probably not be appropriate to model with a normal or <em>t</em>-distribution, and therefore a 2SD interval for estimating the difference in population medians, may not be valid either.</p>
    </solution>
    <response/>
  </exercise>
  
  <p>Although we can certainly use simulation this way to approximate the p-value, it is not feasible to find the <q>exact</q> randomization distribution for a data set of this size. We also notice that the distribution of the difference in medians has less <q>smoothness</q> than the distribution of the differences in means, as certain combinations values are just not possible from a discrete distribution.</p>
  
  <p><alert>Data Transformation</alert></p>
  
  <p>Another approach you saw earlier (<xref ref="inv-2-8">Investigation 2.8</xref>) is to transform the data first.</p>
  
  <exercise xml:id="inv4-7-i" label="I4.7.9">
    <title>Log Transformation</title>
    <statement>
      <p>Determine the (natural) logged rainfall values.</p>
      <ul>
        <li><p>In R: <c>lnrainfall = log(rainfall)</c></p></li>
        <li><p>In JMP: Create a new column with a formula for <c>log(rainfall)</c></p></li>
      </ul>
    </statement>
    <solution>
      <p>Applying the natural log transformation to all rainfall values in both groups should give 0 and 1.589 for the first two values in the unseeded treatment group.</p>
    </solution>
    <response/>
  </exercise>
  
  <exercise xml:id="inv4-7-j" label="I4.7.10">
    <title>Examine Transformed Data</title>
    <statement>
      <p>Create dotplots and/or histograms of ln rainfall amounts by treatment.</p>
      <p>Would you consider the shapes of the distributions to be more symmetric than the original data?</p>
      <p>Would you consider the variability to now be more similar between the two groups?</p>
      <p>Is there still evidence of a positive shift in (ln) rainfall amounts for the seeded clouds?</p>
    </statement>
    <solution>
      <p>Yes, both distributions are more symmetric (skewness values much closer to zero) and the variability is more similar between the two distributions (both SDs around 1.6). There is still evidence of a positive shift in rainfall amounts for the seeded clouds.</p>
      <image source="images/Inv4.7solsjR.jpg" width="80%">
        <description>Dotplots of log-transformed rainfall amounts by treatment (R)</description>
      </image>
      <image source="images/Inv4.7solsjJMP.jpg" width="80%">
        <description>Dotplots of log-transformed rainfall amounts by treatment (JMP)</description>
      </image>
    </solution>
    <response/>
  </exercise>
  
  <exercise xml:id="inv4-7-k" label="I4.7.11">
    <title>Validity After Transformation</title>
    <statement>
      <p>Would you consider it more reasonable to apply two-sample <em>t</em>-procedures to the transformed rainfall amounts than the original data? Explain.</p>
    </statement>
    <solution>
      <p>Yes, now we have symmetric data without huge outliers. The variability is similar in the two groups and the seeded distribution is shifted a bit to higher values. These sample distributions appear symmetric enough to justify applying the two-sample <em>t</em>-procedures.</p>
    </solution>
    <response/>
  </exercise>
  
  <exercise xml:id="inv4-7-l" label="I4.7.12">
    <title>Analysis of Transformed Data</title>
    <statement>
      <p>Calculate the one-sided p-value and the (two-sided) 95% confidence interval based on these data.</p>
    </statement>
    <hint>
      <p>Pay attention to the direction of subtraction by the technology.</p>
    </hint>
    <response/>
    <solution>
      <p>Using two-sample <em>t</em>-procedures on the log-transformed data gives a p-value of approximately 0.007 (one-sided) and a 95% confidence interval of approximately (0.24, 2.05) for the difference in mean log rainfall (seeded minus unseeded).</p>
      <image source="images/Inv4.7solsl1.jpg" width="70%">
        <description>Two-sample t-test output for log-transformed rainfall data</description>
      </image>
      <image source="images/Inv4.7solsl2.jpg" width="50%">
        <description>Additional output for log-transformed rainfall data</description>
      </image>
    </solution>
  </exercise>
  
  <exercise xml:id="inv4-7-m" label="I4.7.13">
    <title>Compare Results</title>
    <statement>
      <p>How does this p-value compare to what you found from simulating a randomization distribution for the difference in medians? What conclusion would you draw from this p-value?</p>
    </statement>
    <solution>
      <p>This p-value (0.007) is a little smaller than the empirical p-value (0.009) from the randomization test on medians. We would consider this p-value very strong evidence against the null hypothesis of no treatment effect.</p>
    </solution>
    <response/>
  </exercise>
  
  <p><alert>Discussion:</alert> It is fairly straight-forward to <q>back-transform</q> our transformation by exponentiating the endpoints of the interval. But we will again focus on the median rather than the mean as the transformed parameter. Also exponentiating an interval for a difference really gives us a ratio in the original scaling <m>[e^{x_1-x_2} = e^{x_1}/e^{x_2}]</m>. In other words, if group 1 is 2 points higher than group 2 on the log scale <m>(x_1 = x_2 + 2)</m>, then group 1 is <m>e^{x_2+2} = e^{x_2}(e^2)</m> or 7.4 times higher in the original scale (or 100 times larger on the log base 10 scale). Therefore, once we apply the back-transformation, we really have an interval of plausible values for the multiplicative change in the median of the response variable.</p>
  
  <exercise xml:id="inv4-7-n" label="I4.7.14">
    <title>Back-Transformation</title>
    <statement>
      <p>Perform the back-transformations and interpret the new confidence interval in terms of a ratio of treatment medians.</p>
    </statement>
    <solution>
      <p>The confidence interval (0.2409, 2.0471) is for the difference in the population means of the logged rainfall volumes.</p>
      <p>Back-transforming: <m>e^{0.24} = 1.27</m>, <m>e^{2.047} = 7.745</m></p>
      <p>We are 95% confident that the underlying treatment median is 1.27 to 7.745 times greater for seeded clouds compared to unseeded clouds.</p>
    </solution>
    <response/>
  </exercise>
  
  <assemblage xml:id="study-conclusions-4-7">
    <title>Study Conclusions</title>
    <p>The rainfall distributions reveal that the rainfall amounts from the seeded clouds have a larger mean and larger variability than from unseeded clouds, and both groups have very right-skewed distributions of rainfall with several high outliers. As both the centers and spreads change, perhaps the treatment effect is more of a percentage change than a simple shift. A two-sample <em>t</em>-test may not be valid for these data. We could consider a randomization test on the medians, but there is no theory-based confidence interval. This is a situation where a ln-transformation is likely to be helpful in rescaling the data so that the <em>t</em>-procedures are more valid. Examining graphs of the transformed data confirm that the variability is now more similar and both shapes are symmetric. The two-sample <em>t</em>-test applied to the ln-transformed data can thus be used as an approximation to the randomization test. Also, the confidence interval for the difference in the ln rainfall can be back-transformed to provide a statement about the multiplicative treatment effect of cloud seeding: We are 95% confident that the median volume of rainfall on days when clouds are seeded is 1.3 to 7.7 times larger when clouds are seeded as opposed to when they are not seeded. (Increasing from 164.59 to 441.98 acre-feet in the sample.) Because random assignment was used to assign the clouds to the seeding conditions, it is safe to interpret this as evidence that the seeding causes larger rainfall amounts on average.</p>
    
    <p>Although the transformation again gives us a comparison of medians, which is often preferable with skewed data and/or outliers, keep in mind, sometimes we really prefer the parameter to be a mean than a median, such as when you want to focus on the <q>total</q> amount (population mean × population size).</p>
  </assemblage>
  
  <subsection xml:id="practice-4-7">
    <title>Practice Problem 4.7</title>
    
    <exercise xml:id="PP4-7-a" label="PP4.7.1">
      <title>Compare Median Analyses to <em>t</em>-Test</title>
      <statement>
        <p>Compare these two analyses using medians to a two-sample <em>t</em>-test and a two-sample <em>t</em>-confidence interval on the original data.</p>
      </statement>
      <response/>
    </exercise>
    
    <exercise xml:id="PP4-7-b" label="PP4.7.2">
      <title>Randomization Distribution for Means</title>
      <statement>
        <p>Examine the randomization distribution for the difference in means (and/or <em>t</em>-statistic). Do the <em>t</em> procedures end up being a reasonable approach for these data?</p>
      </statement>
      <response/>
    </exercise>
  </subsection>
  
</section>
