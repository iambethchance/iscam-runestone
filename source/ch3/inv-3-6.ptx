<?xml version="1.0" encoding="UTF-8"?>
<section xml:id="inv-3-6">
  <title>Investigation 3.6: Is Yawning Contagious?</title>
<introduction>
  <p><em>In this investigation, you will learn how to calculate an "exact" p-value for the randomization distribution you just simulated.</em></p>
</introduction>

<exercises xml:id="investigation3-6" hidden-label="yes">
<title>The Study</title>  
  <introduction>
    <sidebyside widths="55% 40%" margins="0% 5%">
      <p>The folks at <em>MythBusters</em>, a popular television program on the Discovery Channel, investigated whether yawning is contagious by recruiting fifty subjects at a local flea market and asking them to sit in one of three small rooms for a short period of time.  <url href="https://www.youtube.com/watch?v=bCCCxV3nNgs">Video snippet</url></p>
      <image source="images/Inv3.6video.jpg" width="100%">
        <description>Click to watch MythBusters yawning video</description>
        <url href="https://www.youtube.com/watch?v=bCCCxV3nNgs"/>
      </image>
    </sidebyside>
<p>For some of the subjects, the attendee yawned while leading them to two of the rooms (planting a yawn "seed"), whereas for the other subjects the attendee did not yawn while leading to a third room. As time passed, the researchers watched (via a hidden camera) to see which subjects yawned.</p>  </introduction>

  <exercise xml:id="inv3-6-a">
    <title>Identify Variables</title>
    <statement>
      <p>Identify the explanatory variable (EV) and the response variable (RV) in this study.</p>
      <p>EV: <var width="40"/></p>
      <p>RV: <var width="40"/></p>
    </statement>
    <setup>
      <var>
        <condition string=".*[Ss]eed.*|.*[Pp]lant.*|.*[Aa]ttend.*">
          <feedback><p>Correct!</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>The EV is whether the subject was given a yawn seed or not.</p></feedback>
        </condition>
      </var>
      <var>
        <condition string=".*[Yy]awn.*">
          <feedback><p>Correct!</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>The RV is whether the subject yawned or not.</p></feedback>
        </condition>
      </var>
    </setup>
    <solution>
      <p>EV: given seed or not</p>
      <p>RV: whether yawned or not</p>
    </solution>
    <response/>
  </exercise>

  <exercise xml:id="inv3-6-b">
    <title>State Hypotheses</title>
    <statement>
      <p>Define the relevant parameter of interest, and state the null and alternative hypotheses for this study. Be sure to clearly define any symbols that you use.</p>
      <p>Parameter: <var width="60" height="2"/></p>
      <p><m>H_0</m>: <var width="50"/></p>
      <p><m>H_a</m>: <var width="50"/></p>
    </statement>
    <setup>
      <var>
        <condition string=".+">
          <feedback><p>Response recorded.</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>Define the parameter as the difference in probabilities of yawning (seeded - control).</p></feedback>
        </condition>
      </var>
      <var>
        <condition string=".*=\s*0.*|.*no\s*(diff|assoc|effect).*">
          <feedback><p>Correct!</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>H₀ should state no difference: π_s - π_c = 0.</p></feedback>
        </condition>
      </var>
      <var>
        <condition string=".*>\s*0.*|.*greater.*|.*higher.*|.*more.*|.*increase.*|.*contagious.*">
          <feedback><p>Correct!</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>Hₐ should reflect the conjecture that the seed increases yawning probability (π_s - π_c > 0).</p></feedback>
        </condition>
      </var>
    </setup>
    <solution>
      <p>Parameter: π<subscript>s</subscript> - π<subscript>c</subscript> = difference in probability of yawning (seeded - control)</p>
      <p><m>H_0</m>: π<subscript>s</subscript> - π<subscript>c</subscript> = 0 (no association between seeding/not and yawning/not)</p>
      <p><m>H_a</m>: π<subscript>s</subscript> - π<subscript>c</subscript> > 0 (the yawn seed leads to a higher probability of yawning)</p>
    </solution>
    <response/>
  </exercise>

  <paragraphs>
    <p>In the study they found that 10 of 34 subjects who had been given a yawn seed actually yawned themselves, compared with 4 of 16 subjects who had not been given a yawn seed.</p>
  </paragraphs>

  <exercise xml:id="inv3-6-c">
    <title>Create Two-Way Table</title>
    <statement>
      <p>Create a two-way table summarizing the results, <em>using the explanatory variable as the column variable</em>.</p>
        <tabular halign="center" top="minor" bottom="minor" left="minor" right="minor"
        row-headers="yes">
          <row header="yes">
            <cell> Outcome \ Treatment&#160; </cell>
            <cell>&#160; Yawn Seed&#160; </cell>
            <cell>&#160; No Yawn Seed&#160; </cell>
            <cell>&#160; Totals&#160; </cell>
          </row>
          <row>
            <cell halign="left">Yawned</cell>
            <cell><var width="5"/></cell>
            <cell><var width="5"/></cell>
            <cell><var width="5"/></cell>
          </row>
          <row>
            <cell halign="left">Did not yawn</cell>
            <cell><var width="5"/></cell>
            <cell><var width="5"/></cell>
            <cell><var width="5"/></cell>
          </row>
          <row>
            <cell halign="left">Totals</cell>
            <cell><var width="5"/></cell>
            <cell><var width="5"/></cell>
            <cell><var width="5"/></cell>
          </row>
        </tabular>
    </statement>
    <setup>
      <!-- Yawned row -->
      <var>
        <condition number="10" tolerance="0">
          <feedback><p>Correct!</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>10 of the 34 yawn-seed subjects yawned.</p></feedback>
        </condition>
      </var>
      <var>
        <condition number="4" tolerance="0">
          <feedback><p>Correct!</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>4 of the 16 no-seed subjects yawned.</p></feedback>
        </condition>
      </var>
      <var>
        <condition number="14" tolerance="0">
          <feedback><p>Correct!</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>Total yawners: 10 + 4 = 14.</p></feedback>
        </condition>
      </var>
      <!-- Did not yawn row -->
      <var>
        <condition number="24" tolerance="0">
          <feedback><p>Correct!</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>34 - 10 = 24 seed subjects did not yawn.</p></feedback>
        </condition>
      </var>
      <var>
        <condition number="12" tolerance="0">
          <feedback><p>Correct!</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>16 - 4 = 12 no-seed subjects did not yawn.</p></feedback>
        </condition>
      </var>
      <var>
        <condition number="36" tolerance="0">
          <feedback><p>Correct!</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>Total non-yawners: 24 + 12 = 36.</p></feedback>
        </condition>
      </var>
      <!-- Totals row -->
      <var>
        <condition number="34" tolerance="0">
          <feedback><p>Correct!</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>34 subjects were in the yawn-seed group.</p></feedback>
        </condition>
      </var>
      <var>
        <condition number="16" tolerance="0">
          <feedback><p>Correct!</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>16 subjects were in the no-seed group.</p></feedback>
        </condition>
      </var>
      <var>
        <condition number="50" tolerance="0">
          <feedback><p>Correct!</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>Total: 34 + 16 = 50 subjects.</p></feedback>
        </condition>
      </var>
    </setup>
    <solution>
        <tabular halign="center" top="minor" bottom="minor" left="minor" right="minor"
        row-headers="yes">
          <row header="yes">
            <cell>Outcome \ Treatment</cell>
            <cell halign="left">Yawn Seed</cell>
            <cell halign="left">No Yawn Seed</cell>
            <cell halign="left">Totals</cell>
          </row>
          <row>
            <cell>Yawned</cell>
            <cell>10</cell>
            <cell>4</cell>
            <cell>14</cell>
          </row>
          <row>
            <cell>Did not yawn</cell>
            <cell>24</cell>
            <cell>12</cell>
            <cell>36</cell>
          </row>
          <row>
            <cell>Totals</cell>
            <cell>34</cell>
            <cell>16</cell>
            <cell>50</cell>
          </row>
        </tabular>
    </solution>
    <response/>
  </exercise>

  <exercise xml:id="inv3-6-d">
    <title>Design Simulation</title>
    <statement>
      <p>Explain how you would carry out a simulation analysis to approximate a p-value for this study.</p>
      <hint>
        <p>How many cards? How many of each type? How many would you deal out? What would you record? How would you find the p-value?</p>
      </hint>
    </statement>
    <solution>
      <p>50 cards: 14 red, 36 blue. Shuffle. Deal out 34 to "group A." Record the number of red cards in Group A. Repeat many times. Calculate the proportion of red-card-counts that are 10 or higher.</p>
    </solution>
    <response/>
  </exercise>

  <paragraphs>
    <p>Open the <url href="https://www.rossmanchance.com/applets/2021/chisqshuffle/ChiSqShuffle.htm?twobytwo=1">Analyzing Two-way Tables applet</url>.</p>
    <p><ul>
      <li>Paste in the raw data and press <alert>Use Data</alert> or enter the titles and counts of a two-way table and press <alert>Use Table</alert>. (Or check the 2×2 box and enter the cell values and headers). Or use the version below.</li>
      <li>Select <em>GroupA Successes</em> as the <alert>Statistic</alert>.</li>
      <li>Check the <alert>Show Shuffle Options</alert> box.</li>
      <li>Set <alert>Number of Shuffles</alert> to 1000.</li>
      <li>Press <alert>Shuffle</alert>.</li>
    </ul></p>
  </paragraphs>
<interactive iframe="https://www.rossmanchance.com/applets/2021/test/ChiSqShuffle.htm?yawning=2&amp;hideExtras=1" width="160%" aspect="3:2"/>
  <exercise xml:id="inv3-6-e">
    <title>Describe Randomization Distribution</title>
    <statement>
      <p>Briefly describe this randomization (null) distribution: What is its shape? What is the mean? What is the standard deviation?</p>
    </statement>
    <solution>
      <p>Symmetric (but with gaps depending on rounding/bins), mean(π̂<subscript>1</subscript> - π̂<subscript>2</subscript>) ≈ 0, sd(π̂<subscript>1</subscript> - π̂<subscript>2</subscript>) ≈ 0.14</p>
      <p>Example results:</p>
      <image source="images/Inv3.6solse.png" width="70%"/>
    </solution>
    <response/>
  </exercise>

      <p><ul>
        <li>Specify the observed number of successes in the <alert>Count Samples</alert> box.</li>
        <li>Then indicate whether the research conjecture expected a larger or smaller number of successes in the seed treatment by choosing <em>Greater Than</em> or <em>Less Than</em> from the pull-down menu.</li>
        <li>Then press the <alert>Count</alert> button.</li>
      </ul></p>

  <exercise xml:id="inv3-6-f">
    <title>Estimate p-value</title>
    <statement>
      <p>Report your estimate of the p-value: <var width="15"/></p>
    </statement>
    <setup>
      <var>
        <condition number="0.51" tolerance="0.15">
          <feedback><p>Correct! The p-value should be approximately 0.5.</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>The p-value should be approximately 0.5.</p></feedback>
        </condition>
      </var>
    </setup>
    <solution>
      <p>p-value about 0.5</p>
    </solution>
    <response/>
  </exercise>

  <paragraphs>
    <title>Exact p-value</title>
    <p>The simulations you have conducted in Investigations 3.5 (Dolphin Therapy) and above approximated the p-value for two-way tables arising from random assignment by assuming the row and column totals are fixed. In this case, the probability of obtaining a specific number of successes in one group can be calculated exactly using the <em>hypergeometric</em> probability distribution. (We used the independent binomial distributions with the teen hearing loss study, where we wanted to sample separately from two populations and the overall number of successes was not fixed in advance.)</p>
    <p>Keep in mind, that under the null hypothesis, we are assuming the group assignments made no difference and that there would be 14 successes ("yawners") and 36 failures ("non-yawners") between the two groups regardless.</p>
    <p>Because the random assignment makes every configuration of the subjects between the two groups equally likely, we determine the probability of any particular outcome for the number of yawners and non-yawners by first counting the total number of ways to assign 34 of the subjects to the yawn-seed group (and 16 to the no-yawn-seed group) in the denominator. The numerator is then the number of ways to get a particular set of configurations for that group, such as those consisting of 10 yawners and 24 non-yawners.</p>
  </paragraphs>

  <exercise xml:id="inv3-6-g">
    <title>Total Ways to Assign</title>
    <statement>
      <p>How many ways altogether are there to randomly assign these 50 subjects into one group of 34 (yawn-seed group) and the remaining group of 16 (no-yawn-seed group)?</p>
      <hint>
        <p>Recall what you saw earlier with the binomial distribution and counting the number of ways to obtain S successes and F failures in <m>n</m> trials. See the Technical Details in Investigation 1.1.</p>
      </hint>
      <p><var width="40"/></p>
    </statement>
    <setup>
      <var>
        <condition string=".*[Cc]\(50.*34\).*|.*50!.*|.*4\.9.*10.*|.*4923.*">
          <feedback><p>Correct!</p></feedback>
        </condition>
        <condition string=".+">
          <feedback><p>Response recorded. The answer is C(50, 34) = 50!/(34! × 16!) ≈ 4.92 × 10¹².</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>Use the combinations formula C(50, 34).</p></feedback>
        </condition>
      </var>
    </setup>
    <solution>
      <p>C(50, 34) = 50!/(34! × 16!) = 4.92 × 10<m>^{12}</m> possible ways to randomly assign 34 people to group A</p>
    </solution>
    <response/>
  </exercise>

  <exercise xml:id="inv3-6-h">
    <title>Ways to Obtain Observed Configuration</title>
    <statement>
      <p>Now consider the 14 successes and the 36 failures.</p>
      <p>How many ways are there to randomly select 10 of the successes?</p>
      <p>Successes: <var width="20"/></p>
      <p>How many ways are there to randomly assign 24 of the failures to be in the yawn seed group?</p>
      <p>Failures: <var width="20"/></p>
      <p>How should you combine these two numbers to calculate the total number of ways to obtain 10 successes and 24 failures in the yawn-seed group, the configuration that we observed in the study?</p>
      <hint>
        <p>Multiply the number of ways to select successes by the number of ways to select failures.</p>
      </hint>
      <p>Total: <var width="20"/></p>
    </statement>
    <setup>
      <var>
        <condition string="1001|1,001|.*[Cc]\(14.*10\).*">
          <feedback><p>Correct! C(14, 10) = 1,001.</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>Calculate C(14, 10) = 14!/(10! × 4!) = 1,001.</p></feedback>
        </condition>
      </var>
      <var>
        <condition string="125167700|125,167,700|.*[Cc]\(36.*24\).*">
          <feedback><p>Correct! C(36, 24) = 125,167,700.</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>Calculate C(36, 24) = 36!/(24! × 12!) = 125,167,700.</p></feedback>
        </condition>
      </var>
      <var>
        <condition string=".*[Mm]ultipl.*|.*1001.*125.*|.*125.*1001.*|.*1\.25.*10.*11.*|.*[Cc]\(.*\).*\*.*[Cc]\(.*\).*">
          <feedback><p>Correct! Multiply: 1,001 × 125,167,700.</p></feedback>
        </condition>
        <condition string=".+">
          <feedback><p>Response recorded. Multiply the number of ways to select successes by the number of ways to select failures.</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>Multiply the number of ways to select successes by the number of ways to select failures.</p></feedback>
        </condition>
      </var>
    </setup>
    <solution>
      <p>Successes: C(14, 10) = 1,001</p>
      <p>Failures: C(36, 24) = 125,167,700</p>
      <p>To find the total number of possibilities, multiply these two values together</p>
    </solution>
    <response/>
  </exercise>

  <exercise xml:id="inv3-6-i">
    <title>Calculate Exact Probability</title>
    <statement>
      <p>To determine the exact probability that random assignment would produce exactly 10 successes and 24 failures into the group of 34 subjects, divide your calculation in <xref ref="inv3-6-h" text="custom">Question 8</xref> by your calculation in <xref ref="inv3-6-g" text="custom">Question 7</xref>.</p>
      <hint>
        <p>Divide the total number of ways to obtain the observed configuration by the total number of ways to assign subjects.</p>
      </hint>
      <p><var width="30"/></p>
    </statement>
    <setup>
      <var>
        <condition number="0.254" tolerance="0.005">
          <feedback><p>Correct! P(X = 10) ≈ 0.2545.</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>Divide C(14,10) × C(36,24) by C(50,34) to get ≈ 0.2545.</p></feedback>
        </condition>
      </var>
    </setup>
    <solution>
      <p>X = # successes in group A</p>
      <p>P(X = 10) = (1,001 × 125,167,700) / 4.92 × 10<m>^{12}</m> = 0.254</p>
    </solution>
    <response/>
  </exercise>

  <exercise xml:id="inv3-6-j">
    <title>Is this the p-value?</title>
    <statement>
      <p>Explain why your answer to Question 9 is <em>not</em> yet the p-value for this study.</p>
      <p><var width="60" height="3"/></p>
    </statement>
    <setup>
      <var>
        <condition string=".+">
          <feedback><p>Response recorded.</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>The p-value requires P(X ≥ 10), not just P(X = 10).</p></feedback>
        </condition>
      </var>
    </setup>
    <solution>
      <p>No, the p-value would be P(X ≥ 10), not P(X = 10)</p>
    </solution>
    <response/>
  </exercise>

  <assemblage>
    <title>Hypergeometric Distribution</title>
    <p>The probability of obtaining <m>k</m> successes in Group A, with <m>n</m> observations, when sampled from a two-way table with <m>N</m> observations, consisting of <m>M</m> successes and <m>N - M</m> failures is:</p>
    <p><me>P(X = k) = \frac{C(M, k) \times C(N - M, n - k)}{C(N, n)}</me></p>
    <p>where <m>C(N, n) = \frac{N!}{n!(N - n)!}</m> is the number of ways to choose <m>n</m> items from a group of <m>N</m> items, and <m>X</m> represents the number of successes randomly selected for group A. <m>X</m> is a hypergeometric random variable. Also note <m>E(X) = n(M/N)</m> and <m>SD(X) = \sqrt{n(M/N)(1 - M/N)(N - n)/(N - 1)}</m>.</p>
  </assemblage>

  <paragraphs>
    <p>In this study, we had <m>N = 50</m> subjects and we defined yawning to be success so <m>M = 14</m>. We also arbitrarily chose to focus on the yawn-seed group, so <m>n = 34</m>. This calculation works out the same if you had defined "not yawning" to be a success and/or if you had focused on the 16 people in the no-yawn-seed group. You just need to make sure you count consistently.</p>
    <p>We will continue to define the p-value to be the probability of obtaining results <em>at least as extreme</em> as those observed in the actual study. Because we expected more yawners in the yawn-seed group, the p-value is the probability of randomly assigning at least 10 of the yawners in the yawn-seed group.</p>
    <p>So far you have found <m>P(X = 10) = C(14, 10) \times C(36, 24) / C(50, 34) = 0.2545</m>.</p>
  </paragraphs>

  <exercise xml:id="inv3-6-k">
    <title>Calculate Additional Probabilities</title>
    <statement>
      <p>Calculate P(X = 11), P(X = 12), P(X = 13), and P(X = 14) using the hypergeometric probability formula.</p>
      <p>P(X = 11) = <var width="15"/></p>
      <p>P(X = 12) = <var width="15"/></p>
      <p>P(X = 13) = <var width="15"/></p>
      <p>P(X = 14) = <var width="15"/></p>
      <p>Why do we stop at 14?</p>
      <p><var width="60" height="2"/></p>
    </statement>
    <setup>
      <!-- P(X=11) -->
      <var>
        <condition number="0.1708" tolerance="0.005">
          <feedback><p>Correct!</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>P(X = 11) = C(14,11) × C(36,23) / C(50,34) ≈ 0.1708.</p></feedback>
        </condition>
      </var>
      <!-- P(X=12) -->
      <var>
        <condition number="0.0702" tolerance="0.005">
          <feedback><p>Correct!</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>P(X = 12) = C(14,12) × C(36,22) / C(50,34) ≈ 0.0702.</p></feedback>
        </condition>
      </var>
      <!-- P(X=13) -->
      <var>
        <condition number="0.0158" tolerance="0.005">
          <feedback><p>Correct!</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>P(X = 13) = C(14,13) × C(36,21) / C(50,34) ≈ 0.0158.</p></feedback>
        </condition>
      </var>
      <!-- P(X=14) -->
      <var>
        <condition number="0.0015" tolerance="0.002">
          <feedback><p>Correct!</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>P(X = 14) = C(14,14) × C(36,20) / C(50,34) ≈ 0.0015.</p></feedback>
        </condition>
      </var>
      <!-- Why stop at 14 -->
      <var>
        <condition string=".+">
          <feedback><p>Response recorded.</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>We stop at 14 because there are only 14 total successes.</p></feedback>
        </condition>
      </var>
    </setup>
    <solution>
      <p>P(X = 11) ≈ 0.1708; P(X = 12) ≈ 0.0702; P(X = 13) ≈ 0.0158; P(X = 14) ≈ 0.0015</p>
      <p>We stop at 14 because this is the total # successes</p>
    </solution>
    <response/>
  </exercise>

  <exercise xml:id="inv3-6-l">
    <title>Exact p-value and Interpretation</title>
    <statement>
      <p>Sum all five probabilities together (including P(X = 10)) to determine the exact p-value for the yawning study. How does this p-value compare to the empirical p-value from the applet simulation? Write a one or two sentence interpretation of this p-value.</p>
      <p>Exact p-value: <var width="15"/></p>
      <p>Comparison: <var width="40"/></p>
      <p>Interpretation: <var width="60" height="3"/></p>
    </statement>
    <setup>
      <!-- Exact p-value -->
      <var>
        <condition number="0.513" tolerance="0.005">
          <feedback><p>Correct! The exact p-value is 0.5128.</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>Sum: 0.254 + 0.1708 + 0.0702 + 0.0158 + 0.0015 = 0.5128.</p></feedback>
        </condition>
      </var>
      <!-- Comparison -->
      <var>
        <condition string=".+">
          <feedback><p>Response recorded.</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>Compare to your simulation p-value.</p></feedback>
        </condition>
      </var>
      <!-- Interpretation -->
      <var>
        <condition string=".+">
          <feedback><p>Response recorded.</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>Interpret the p-value in context of the random assignment.</p></feedback>
        </condition>
      </var>
    </setup>
    <solution>
      <p>Exact p-value: 0.254 + 0.1708 + 0.0702 + 0.0158 + 0.0015 = 0.5128</p>
      <p>Comparison: similar to simulation</p>
      <p>Interpretation: P(X ≥ 10), probability of 10 or more successes by random assignment alone (assuming no effect from the seed). If the yawn seed has no effect, the probability of finding 10 or more of 34 yawners in the seeded group when 50 subjects are randomly assigned to seeded and no-seed groups is 0.5128.</p>
    </solution>
    <response/>
  </exercise>

  <assemblage>
    <title>Definition: Fisher's Exact Test</title>
    <p>Using the hypergeometric probabilities to determine a p-value in this fashion for a two-way table is called <term>Fisher's Exact Test</term><idx><h>Fisher's Exact Test</h></idx>, named after <url href="https://en.wikipedia.org/wiki/Ronald_Fisher">R. A. Fisher</url>.</p>
  </assemblage>

  <p class="horizontal-rule"> </p>

  <paragraphs xml:id="tech-detour-hypergeometric-inv3-6">
    <title>Technology Detour – Calculating Hypergeometric Probabilities (Fisher's Exact Test)</title>
    <p>Use technology to calculate hypergeometric probabilities (Fisher's Exact Test) for two-way tables. You need to specify the total number of observations (<m>N</m>), the number of successes (<m>M</m>), and the sample size (<m>n</m>).</p>
  </paragraphs>

  <paragraphs>
    <hint>
      <title>Applet Instructions</title>
      <p>In the <url href="https://www.rossmanchance.com/applets/2021/chisqshuffle/ChiSqShuffle.htm?usetwobytwo=1">Analyzing Two-way Tables applet</url>:</p>
      <p><ul>
        <li>Choose the 2×2 box to enter the cell values and headers for a two-way table</li>
        <li>Enter the two-way table (and row and column headers)</li>
        <li>Press <alert>Use Table</alert></li>
        <li>Check the box for <alert>Show Fisher's Exact Test</alert> in the lower left corner</li>
        <li>A check box will appear for determining the two-sided p-value</li>
      </ul></p>
      <p>Example applet output:</p>
      <image source="images/Inv3.6applet.jpg" width="70%"/>
    </hint>
    <hint>
      <title>R Instructions</title>
      <p>The <c>iscamhyperprob</c> function takes the following inputs:</p>
      <p><ul>
        <li><c>k</c>, the observed value of interest (or the difference in conditional proportions, assumed if value is less than one, including negative)</li>
        <li><c>total</c>, the total number of observations in the two-way table</li>
        <li><c>succ</c>, the overall number of successes in the table</li>
        <li><c>n</c>, the number of observations in "group A"</li>
        <li><c>lower.tail</c>, a Boolean which is TRUE or FALSE</li>
      </ul></p>
      <p>For example:</p>
      <sage language="r">
        <input>
        <![CDATA[
# Load ISCAM functions from GitHub
invisible(source("https://raw.githubusercontent.com/iambethchance/iscam-runestone/master/ISCAM-functions.R"))

#Calculate probability from hypergeometric distribution
iscamhyperprob(k=10, total=50, succ=14, n=34, lower.tail=FALSE)
]]>
        </input>
      </sage>
      <p>Example R output:</p>
      <image source="images/Inv3.6solsR.jpg" width="70%"/>
    </hint>
    <hint>
      <title>JMP Instructions</title>
      <p>Using the Distribution Calculator:</p>
      <p><ul>
        <li>Choose <term index="no">Hypergeometric</term> from the Distribution menu</li>
        <li>Specify the values of Population Size = table total, Number of Items = total number of successes, Sample Size = group 1 total</li>
        <li>Select <term index="no">Input quantiles and compute probabilities</term></li>
        <li>Specify the upper tail probability and enter Qa = number of successes in "group A" (minus 1)</li>
      </ul></p>
      <p>Keep in mind: To find <m>P(X \geq k)</m> use <m>P(X > k-1)</m>.</p>
      <p>Example JMP output:</p>
      <image source="images/Inv3.6solsJMP.png" width="70%"/>
    </hint>
  </paragraphs>

  <p class="horizontal-rule"> </p>

  <exercise xml:id="inv3-6-m" label="inv3-6-m">
    <title>Exact p-value</title>
    <statement>
      <p>Calculate this hypergeometric probability using technology (using one of the methods above). Did the technology confirm your by-hand calculation?</p>
    </statement>
    <choices randomize="no">
      <choice correct="yes">
        <statement><p>Yes, the technology confirmed the by-hand p-value.</p></statement>
        <feedback><p>Correct! The technology should give the same exact p-value.</p></feedback>
      </choice>
      <choice>
        <statement><p>No, the technology gave a noticeably different p-value.</p></statement>
        <feedback><p>Double-check your technology inputs: N = 50, M = 14, n = 34, k = 10, upper tail. You should get 0.5128.</p></feedback>
      </choice>
    </choices>
    <solution>
      <p><m>P(X ≥ 10)</m> with <m>M = 14</m>, <m>n = 34</m>, <m>N = 50</m>; p-value = 0.5128</p>
    </solution>
  </exercise>

  <exercise xml:id="inv3-6-n">
    <title>Alternative Setup - Not Yawning</title>
    <statement>
      <p>Set up and carry out the calculation to determine the exact p-value where you define the success to be "not yawning" and the group of interest to be the yawn seed group. </p>
      <p>Let X = <var width="60" height="4"/></p>
      <p>Find P(X <var width="20" height="4"/><var width="20" height="4"/></p>
      <p>p-value <var width="60" height="4"/></p>
    </statement>
    <setup>
      <!-- Let X = ... -->
      <var>
        <condition string=".*[Nn]on.?yawn.*|.*[Nn]ot\s+yawn.*|.*[Dd]id(n't| not)\s+yawn.*|.*36.*">
          <feedback><p>Correct!</p></feedback>
        </condition>
        <condition string=".+">
          <feedback><p>Response recorded. X should represent the number of non-yawners in the yawn seed group.</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>Define X as the number of non-yawners in the yawn seed group.</p></feedback>
        </condition>
      </var>
      <!-- P(X ___ ) inequality symbol -->
      <var>
        <condition string=".*&lt;=.*|.*≤.*|.*less.*">
          <feedback><p>Correct! ≤</p></feedback>
        </condition>
        <condition string=".+">
          <feedback><p>Response recorded. The inequality should be ≤.</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>Since "not yawning" is now the success, we want P(X ≤ 24).</p></feedback>
        </condition>
      </var>
      <!-- P(X ___ ) inequality number -->
      <var>
        <condition number="24" tolerance="0">
          <feedback><p>Correct! P(X ≤ 24).</p></feedback>
        </condition>
        <condition string=".+">
          <feedback><p>Response recorded. The observed count of non-yawners in the seed group is 24.</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>How many non-yawners were in the yawn seed group?</p></feedback>
        </condition>
      </var>
      <!-- p-value result -->
      <var>
        <condition string="0?\.51\d*">
          <feedback><p>Correct! The p-value is 0.5128.</p></feedback>
        </condition>
        <condition string=".+">
          <feedback><p>Response recorded. The exact p-value should be 0.5128.</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>Use the hypergeometric distribution with M = 36, n = 34, N = 50.</p></feedback>
        </condition>
      </var>
    </setup>
    <solution>
      <p><m>P(X ≤ 24)</m> with <m>M = 36</m>, <m>n = 34</m>, <m>N = 50</m> = 0.5128</p>
      <image source="images/Inv3.6solsn.png" width="70%"/>
    </solution>
    <response/>
  </exercise>

  <exercise xml:id="inv3-6-o">
    <title>Alternative Setup - No Seed Group</title>
    <statement>
      <p>Set up and carry out the calculation to determine the exact p-value, where you focus on the number that did not yawn in the no-yawn-seed group. Show that you obtain the same exact p-value as before.</p>
      <p>Let X = <var width="60" height="4"/></p>
      <p>Find P(X <var width="20" height="4"/><var width="20" height="4"/></p>
      <p>same p-value? <var width="10"/></p>
    </statement>
    <setup>
      <!-- Let X = ... -->
      <var>
        <condition string=".*[Nn]on.?yawn.*|.*[Nn]ot\s+yawn.*|.*[Dd]id(n't| not)\s+yawn.*|.*36.*|.*16.*">
          <feedback><p>Correct!</p></feedback>
        </condition>
        <condition string=".+">
          <feedback><p>Response recorded. X should represent the number of non-yawners in the no-seed group.</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>Define X as the number of non-yawners in the no-yawn-seed group.</p></feedback>
        </condition>
      </var>
      <!-- P(X ___ ) inequality symbol -->
      <var>
        <condition string=".*&gt;=.*|.*≥.*|.*greater.*">
          <feedback><p>Correct! ≥</p></feedback>
        </condition>
        <condition string=".+">
          <feedback><p>Response recorded. The inequality should be ≥.</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>Since we focus on non-yawners in the no-seed group, we want P(X ≥ 12).</p></feedback>
        </condition>
      </var>
      <!-- P(X ___ ) inequality number -->
      <var>
        <condition number="12" tolerance="0">
          <feedback><p>Correct! P(X ≥ 12).</p></feedback>
        </condition>
        <condition string=".+">
          <feedback><p>Response recorded. The observed count of non-yawners in the no-seed group is 12.</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>How many non-yawners were in the no-seed group?</p></feedback>
        </condition>
      </var>
      <!-- same p-value? -->
      <var>
        <condition string="[Yy]es">
          <feedback><p>Correct! The p-value is the same: 0.5128.</p></feedback>
        </condition>
        <condition string="[Nn]o">
          <feedback><p>Double-check your calculation. With <m>M = 36, n = 16, N = 50, P(X ≥ 12) = 0.5128</m>, the same as before.</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>Answer yes or no: did you obtain the same p-value of 0.5128?</p></feedback>
        </condition>
      </var>
    </setup>
    <solution>
      <p><m>P(X ≥ 12)</m> with <m>M = 36</m>, <m>n = 16</m>, <m>N = 50</m> = 0.5128</p>
      <image source="images/Inv3.6solso.jpg" width="70%"/>
    </solution>
    <response/>
  </exercise>

  <paragraphs>
    <title>Discussion</title>
    <p>You should see that there are several equivalent ways to set up the probability calculation. Make sure it is clear how you define success/failure and which group you are considering "group A." This will help you determine the numerical values for <m>N</m>, <m>M</m>, and <m>n</m> in the calculation.</p>
    <p>Below is a graph of the Hypergeometric distribution with <m>N = 50</m>, <m>M = 14</m>, and <m>n = 34</m>.</p>
    <image source="images/Inv3.6hyper.png" width="70%"/>
    <p>Using probability rules, you can show that the expected value of this distribution is <m> (14/50) \times 34 = 9.52</m> yawners in yawn seed group and the standard deviation of the probability distribution is the square root of <m>n \times (M/N) \times (N – M)/N \times (N – n)/(N – 1) = 1.496</m> yawners.</p>
  </paragraphs>

  <exercise xml:id="inv3-6-p">
    <title>Compare to Simulation</title>
    <statement>
      <p>Compare this graph and the mean and standard deviation values to your simulation results.</p>
      <p><var width="60" height="3"/></p>
    </statement>
    <setup>
      <var>
        <condition string=".+">
          <feedback><p>Response recorded.</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>Please compare the theoretical and simulation results.</p></feedback>
        </condition>
      </var>
    </setup>
    <solution>
      <p>The simulation results should be very similar, including the mean and standard deviation values when using the count scale.</p>
<p> Example results</p>      <image source="images/Inv3.6solsp.jpg" width="70%"/>
    </solution>
    <response/>
  </exercise>

  <exercise xml:id="inv3-6-q">
    <title>MythBusters Conclusion</title>
    <statement>
      <p>On the <em>MythBusters</em> program, the hosts concluded that, based on the observed difference in conditional proportions and the large sample size, there is "little doubt, yawning seems to be contagious." Do you agree?</p>
    </statement>
    <setup>
      <var>
        <condition string=".+">
          <feedback><p>Response recorded.</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>Consider the p-value when evaluating this claim.</p></feedback>
        </condition>
      </var>
    </setup>
    <solution>
      <p>The p-value is not small so we fail to reject H<subscript>0</subscript>. We do not have convincing evidence of a seeding effect.</p>
    </solution>
    <response/>
  </exercise>

  <exercise xml:id="inv3-6-r">
    <title>Generalizability</title>
    <statement>
      <p>To what population are you willing to generalize these results? Explain your reasoning.</p>
    </statement>
    <setup>
      <var>
        <condition string=".+">
          <feedback><p>Response recorded.</p></feedback>
        </condition>
        <condition string=".*">
          <feedback><p>Consider the sampling method used in this study.</p></feedback>
        </condition>
      </var>
    </setup>
    <solution>
      <p>No! We are not able to discount "chance" (random assignment) as the explanation for the observed difference in the sample proportions. We should be cautious about generalizing beyond volunteers at a local flea market, as this was not a random sample from a broader population.</p>
    </solution>
    <response/>
  </exercise>

  <assemblage>
    <title>Study Conclusions</title>
    <p>With a large p-value of 0.513 (Fisher's Exact Test), we do not have any evidence that the difference between the two groups (with and without yawn seed) was created from something other than the random assignment process. If there was nothing to the theory that yawning is contagious, by "luck of the draw" alone, we would expect 10 or more of the yawners to end up in the yawn seed group in more than 50% of random assignments. Although the study results were in the conjectured direction, the difference between the yawning proportions was not large enough to convince us that the probability of yawning is truly larger when a yawn seed is planted. The researchers could try the study again with a larger sample size to increase the power of their test. The researchers also may want to be cautious in generalizing these results beyond the population of volunteers at a local flea market or how naturalistic the setting of leading individuals to a small room to wait is.</p>
  </assemblage>
</exercises>

  <subsection xml:id="practice3-6A">
    <title>Practice Problem 3.6A</title>

    <exercise xml:id="practice-3-6-a-a">
      <title>Evidence Against Contagious Yawning</title>
      <statement>
        <p>For the <em>MythBusters</em> study (p-value > 0.5), is it reasonable to conclude from this study that we have strong evidence that yawning is not contagious? Explain.</p>
      </statement>
      <response/>
    </exercise>

    <exercise xml:id="practice-3-6-a-b">
      <title>Sample Size and Power</title>
      <statement>
        <p>Explain, in this context, what is meant in the Study Conclusions box by "the researchers could try the study again with a larger sample size to increase the power of their test" and why that is a reasonable recommendation here.</p>
      </statement>
      <response/>
    </exercise>

    <exercise xml:id="practice-3-6-a-c">
      <title>Hypergeometric vs Binomial</title>
      <statement>
        <p>To calculate the p-value here, why are we using the hypergeometric distribution instead of the binomial distribution?</p>
      </statement>
      <response/>
    </exercise>
  </subsection>

  <subsection xml:id="practice3-6B">
    <title>Practice Problem 3.6B</title>

    <p>Reconsider the Dolphin Therapy study (Investigation 3.5).</p>
  <tabular top="minor" bottom="minor" left="minor" right="minor" row-headers="yes">
        <col halign="left"/>
        <col halign="center"/>
        <col halign="center"/>
        <col halign="center"/>
        <row header="yes">
          <cell>Outcome \ Treatment</cell>
          <cell>Dolphin Therapy</cell>
          <cell>Control Group</cell>
          <cell>Total</cell>
        </row>
        <row>
          <cell>Showed substantial improvement</cell>
          <cell>10</cell>
          <cell>3</cell>
          <cell>13</cell>
        </row>
        <row>
          <cell>Did not show substantial improvement</cell>
          <cell>5</cell>
          <cell>12</cell>
          <cell>17</cell>
        </row>
        <row>
          <cell>Total</cell>
          <cell>15</cell>
          <cell>15</cell>
          <cell>30</cell>
        </row>
      </tabular>
    <p>Continue to focus on the number of improvers randomly assigned to the dolphin group, and represent this value by <m>X</m>.</p>

    <exercise xml:id="practice-3-6-b-a">
      <title>Hypergeometric Parameters</title>
      <statement>
        <p>When the null hypothesis is true, the random variable <m>X</m> has a hypergeometric distribution. Specify the values of <m>N</m>, <m>M</m>, and <m>n</m>.</p>
        <p><m>N</m> = <var width="10"/></p>
        <p><m>M</m> = <var width="10"/></p>
        <p><m>n</m> = <var width="10"/></p>
      </statement>
      <setup>
        <var>
          <condition string=".+">
            <feedback><p>Response recorded.</p></feedback>
          </condition>
          <condition string=".*">
            <feedback><p>Please enter your answer.</p></feedback>
          </condition>
        </var>
        <var>
          <condition string=".+">
            <feedback><p>Response recorded.</p></feedback>
          </condition>
          <condition string=".*">
            <feedback><p>Please enter your answer.</p></feedback>
          </condition>
        </var>
        <var>
          <condition string=".+">
            <feedback><p>Response recorded.</p></feedback>
          </condition>
          <condition string=".*">
            <feedback><p>Please enter your answer.</p></feedback>
          </condition>
        </var>
      </setup>
      <response/>
    </exercise>

    <exercise xml:id="practice-3-6-b-b">
      <title>Setup for Exact p-value</title>
      <statement>
        <p>Calculating the exact p-value involves finding <m>P(X</m> __________).</p>
        <hint>
          <p>Fill in the blank with an inequality symbol and a number.</p>
        </hint>
        <p><m>P(X</m> <var width="20"/>)</p>
      </statement>
      <setup>
        <var>
          <condition string=".+">
            <feedback><p>Response recorded.</p></feedback>
          </condition>
          <condition string=".*">
            <feedback><p>Please enter your answer.</p></feedback>
          </condition>
        </var>
      </setup>
      <response/>
    </exercise>

    <exercise xml:id="practice-3-6-b-c">
      <title>Calculate Exact p-value</title>
      <statement>
        <p>Calculate this exact p-value, either by hand or with technology. Comment on whether this p-value is similar to the approximate one from your simulation results. (Be sure it's clear how you calculated this value.)</p>
        <p><var width="60" height="4"/></p>
      </statement>
      <setup>
        <var>
          <condition string=".+">
            <feedback><p>Response recorded.</p></feedback>
          </condition>
          <condition string=".*">
            <feedback><p>Please enter your answer.</p></feedback>
          </condition>
        </var>
      </setup>
      <response/>
    </exercise>

    <exercise xml:id="practice-3-6-b-d">
      <title>Double the Sample Size</title>
      <statement>
        <p>Suppose that the dolphin study had involved twice as many subjects, again with half randomly assigned to each group, and with the same proportion of improvers in each group. Determine the exact p-value in this case, and comment on whether/how it changes from the p-value with the real data. Explain why this makes sense.</p>
        <p><var width="60" height="4"/></p>
      </statement>
      <setup>
        <var>
          <condition string=".+">
            <feedback><p>Response recorded.</p></feedback>
          </condition>
          <condition string=".*">
            <feedback><p>Please enter your answer.</p></feedback>
          </condition>
        </var>
      </setup>
      <response/>
    </exercise>
  </subsection>

  <subsection xml:id="practice3-6C">
    <title>Practice Problem 3.6C</title>

    <exercise xml:id="practice-3-6-c-a">
      <title>Alternative Setup - Not Yawning</title>
      <statement>
        <p>Suppose I wanted to treat "not yawning" as a success. Consider <m>Y</m> = number of non-yawners in the yawn seed group. Show how to set up the hypergeometric calculation of</p>
        <p><m>P(Y = 24) = C(</m><var width="5"/>, <var width="5"/><m>) \times C(</m><var width="5"/>, <var width="5"/><m>) / C(</m><var width="5"/>, <var width="5"/>)</p>
      </statement>
      <setup>
        <!-- C(M, k): M = number of successes (non-yawners) = 36 -->
        <var>
          <condition number="36" tolerance="0">
            <feedback><p>Correct! M = 36 non-yawners total.</p></feedback>
          </condition>
          <condition string=".*">
            <feedback><p>How many total non-yawners (successes) are there? 24 + 12 = 36.</p></feedback>
          </condition>
        </var>
        <!-- C(M, k): k = 24 non-yawners in seed group -->
        <var>
          <condition number="24" tolerance="0">
            <feedback><p>Correct! k = 24 non-yawners in the seed group.</p></feedback>
          </condition>
          <condition string=".*">
            <feedback><p>How many non-yawners were in the yawn seed group?</p></feedback>
          </condition>
        </var>
        <!-- C(N-M, n-k): N-M = 14 yawners (failures) -->
        <var>
          <condition number="14" tolerance="0">
            <feedback><p>Correct! N - M = 50 - 36 = 14 yawners.</p></feedback>
          </condition>
          <condition string=".*">
            <feedback><p>How many total yawners (failures) are there? 50 - 36 = 14.</p></feedback>
          </condition>
        </var>
        <!-- C(N-M, n-k): n-k = 10 yawners in seed group -->
        <var>
          <condition number="10" tolerance="0">
            <feedback><p>Correct! n - k = 34 - 24 = 10 yawners in the seed group.</p></feedback>
          </condition>
          <condition string=".*">
            <feedback><p>How many yawners were in the yawn seed group? 34 - 24 = 10.</p></feedback>
          </condition>
        </var>
        <!-- C(N, n): N = 50 total -->
        <var>
          <condition number="50" tolerance="0">
            <feedback><p>Correct! N = 50 total subjects.</p></feedback>
          </condition>
          <condition string=".*">
            <feedback><p>What is the total number of subjects?</p></feedback>
          </condition>
        </var>
        <!-- C(N, n): n = 34 in seed group -->
        <var>
          <condition number="34" tolerance="0">
            <feedback><p>Correct! n = 34 in the yawn seed group.</p></feedback>
          </condition>
          <condition string=".*">
            <feedback><p>How many subjects were in the yawn seed group?</p></feedback>
          </condition>
        </var>
      </setup>
      <response/>
    </exercise>

    <exercise xml:id="practice-3-6-c-b">
      <title>Technology Calculation - Non-yawners</title>
      <statement>
        <p>Use technology to calculate the probability of 24 or fewer non-yawners in the YawnSeed group using the hypergeometric distribution. (Include output.) How does this compare to the probability of 10 or more yawners in the YawnSeed group?</p>
        <p><var width="60" height="4"/></p>
      </statement>
      <setup>
        <var>
          <condition string=".+">
            <feedback><p>Response recorded.</p></feedback>
          </condition>
          <condition string=".*">
            <feedback><p>Please enter your answer.</p></feedback>
          </condition>
        </var>
      </setup>
      <response/>
    </exercise>

    <exercise xml:id="practice-3-6-c-c">
      <title>No Seed Group Probability</title>
      <statement>
        <p>Suppose I want to find the probability of 4 or fewer yawners in the No Seed group. Identify the values of <m>N</m>, <m>M</m>, <m>n</m>, and <m>k</m>. Use technology to calculate the probability of 4 or fewer yawners in the No Seed group using the hypergeometric distribution. (Include readable output.)</p>
        <p><var width="60" height="4"/></p>
      </statement>
      <setup>
        <var>
          <condition string=".+">
            <feedback><p>Response recorded.</p></feedback>
          </condition>
          <condition string=".*">
            <feedback><p>Please enter your answer.</p></feedback>
          </condition>
        </var>
      </setup>
      <response/>
    </exercise>

    <exercise xml:id="practice-3-6-c-d">
      <title>Importance of Blinding</title>
      <statement>
        <p>In the Yawning study, why was it important that the subjects didn't know what the study was about when they were led into the room?</p>
      </statement>
      <response/>
    </exercise>

    <exercise xml:id="practice-3-6-c-e">
      <title>Unequal Sample Sizes</title>
      <statement>
        <p>In the Yawning study, is it a problem that the sample sizes for the Yawn seed and the No Yawn seed group aren't equal? Explain.</p>
      </statement>
      <response/>
    </exercise>
  </subsection>

</section>
